digraph {
  graph [fontsize=12, fontname=Ubuntu, penwidth=3];
  node [fontsize=12, fontname=Ubuntu, shape=circle];
  edge [fontsize=12, fontname=Ubuntu];
  nodesep=3;
  overlap=false;
  root=onEstablishPilesContainer;
  dim=4;
  mode=ipsep;
  sep=0.4
    bgcolor="#fde725";
    
  // Persisters
  PilesPersister -> DeckStore [label="setPart"];
  PilesPersister -> DeckStore [label="get"];
  deckIdsPersister -> localStorage [label="setItem"];
  thingPersister -> localStorage [label="setItem"];

    // Stores
    DeckCollectionStore;
    DeckStore [shape=doublecircle];
    activeDeckIdentifier;
    PileCollectionStore;
    PileStore [shape=doublecircle];


    // Responders
    onDeckCollectionChange;
    onDeckChange [shape=doublecircle];
    onPileCollectionChange;
    onPileChange [shape=doublecircle];
    onEstablishPilesContainer [shape=doublecircle];

    DeckCollectionStore -> onDeckCollectionChange;
    DeckCollectionStore -> deckIdsPersister [label="write"];
    activeDeckIdentifier -> onDeckCollectionChange;
    DeckStore -> onDeckChange;
    DeckStore -> thingPersister [style=dashed, label="write"];
    PileCollectionStore -> onPileCollectionChange;
    PileStore -> onPileChange;
    PileStore -> thingPersister [style=dashed, label="write"];
    PileCollectionStore -> PilesPersister [style=dashed, label="write"]


    // Renderers
    RenderDeckCollection;
    RenderDeck [shape=doublecircle];
    RenderPileCollection;
    RenderPile [shape=doublecircle];

    onDeckCollectionChange -> RenderDeckCollection;
    onDeckChange -> RenderDeck;
    RenderDeck -> onEstablishPilesContainer [style=dashed, label="(one-time)"];
    onEstablishPilesContainer -> RenderPileCollection;
    onEstablishPilesContainer -> RenderPile;

    onPileCollectionChange -> RenderPileCollection;
    onPileChange -> RenderPile;

    // Updaters
    addDeck -> DeckCollectionStore;
    addPile -> PileCollectionStore [label="add"];
    RenderDeckCollection -> addDeck [style=dashed];
    RenderDeck -> activeDeckIdentifier [style=dashed, label="setPart"];
    RenderDeck -> DeckStore [style=dashed, label="setPart"];
    RenderDeck -> DeckStore [style=dashed, label="del"];
    RenderDeck -> DeckCollectionStore [style=dashed, label="remove"];
    RenderPileCollection -> addPile [style=dashed];
    RenderPile -> PileCollectionStore [style=dashed, label="remove"];
    RenderPile -> PileStore [style=dashed, label="del"];
    RenderPile -> PileStore [style=dashed, label="setPart"];
  }